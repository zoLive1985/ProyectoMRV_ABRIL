function wfu_run_js_from_bank(){if("undefined"!=typeof WFU_JS_BANK)for(;WFU_JS_BANK.length>0;){var e=wfu_js_decode_obj(WFU_JS_BANK[0].obj_str);e&&e[WFU_JS_BANK[0].func].call(e),WFU_JS_BANK.splice(0,1)}}function wfu_Initialize_Consts(e){if(void 0===GlobalData.consts){GlobalData.consts=new Object;for(var a=e.split(";"),t=0;t<a.length;t++)const_txt=a[t].split(":"),GlobalData.consts[wfu_plugin_decode_string(const_txt[0])]=wfu_plugin_decode_string(const_txt[1])}}function wfu_Load_Code_Connectors(e){"undefined"==typeof wfu_Code_Objects&&(wfu_Code_Objects={}),wfu_Code_Objects[e]=new wfu_Code_Object(e);for(var a=0;a<Code_Initializators.length;a++)wfu_Code_Objects[e].additem(Code_Initializators[a](e))}function wfu_Code_Object(e){this.sid=e,this.items=[],this._calc_prioritized_list=function(e){for(var a,t,r=[],s=[],o=[],n=0;n<this.items.length;n++)(a=this.items[n])[e]&&(t=-1,a.priority&&(t=a.priority),a[e].priority&&(t=a[e].priority),t>=0?(r.push(t),s.push(n)):o.push(n));for(n=1;n<r.length;n++)for(var i=n;i<r.length;i++)if(r[i]<r[n-1]){var l=r[i];r[i]=r[n-1],r[n-1]=l,l=s[i],s[i]=s[n-1],s[n-1]=l}return s.concat(o)},this.additem=function(e){this.items.push(e)},this.apply_filters=function(e,a){if(void 0===a)return null;var t=this._calc_prioritized_list(e);if(0==t.length)return a;for(var r=0;r<t.length;r++){var s=this.items[t[r]],o=null;"function"==typeof s[e]?o=s[e]:"function"==typeof s[e].func&&(o=s[e].func),null!=o&&(a=o.apply(this,Array.prototype.slice.call(arguments,1)),arguments[1]=a)}return a},this.do_action=function(e){var a=this._calc_prioritized_list(e);if(0!=a.length)for(var t=0;t<a.length;t++){var r=this.items[a[t]],s=null;"function"==typeof r[e]?s=r[e]:"function"==typeof r[e].func&&(s=r[e].func),null!=s&&s.apply(this,Array.prototype.slice.call(arguments,1))}}}function wfu_plugin_load_action(e){var a=GlobalData.WFU[e];wfu_Code_Objects[e].do_action("pre_load"),wfu_install_unload_hook(),a.visualeditorbutton_exist&&(a.visualeditorbutton.init(),a.visualeditorbutton.attachInvokeHandler((function(){wfu_invoke_shortcode_editor(a)}))),a.is_formupload?a.uploadaction=function(){wfu_redirect_to_classic(e,0,0)}:a.uploadaction=function(){wfu_HTML5UploadFile(e)};var t=function(){wfu_selectbutton_clicked(e)};a.uploadform_exist&&a.uploadform.attachActions(t,(function(a){var t=GlobalData.WFU[e];wfu_selectbutton_changed(e,0),wfu_update_uploadbutton_status(e),t.singlebutton&&a&&t.uploadaction()})),a.consent_exist&&(a.consent.attachActions((function(a){wfu_set_stored_formdata(e,"consentresult_"+e,a)})),a.consent.update("init")),a.submit_exist&&(t=a.testmode?function(){alert(GlobalData.consts.notify_testmode)}:function(){a.uploadaction()},a.submit.attachClickAction(t))}function wfu_install_unload_hook(){window.onbeforeunload=wfu_unload_hook}function wfu_unload_hook(){if(""!=GlobalData.UploadInProgressString&&""!=GlobalData.UploadInProgressString.trim())return GlobalData.consts.wfu_pageexit_prompt}function wfu_Check_Browser_Capabilities(){if("undefined"==typeof wfu_BrowserCaps){wfu_BrowserCaps=new Object;var e=wfu_GetHttpRequestObject();wfu_BrowserCaps.supportsAJAX=null!=e,wfu_BrowserCaps.supportsUploadProgress=!!(e&&"upload"in e&&"onprogress"in e.upload);var a=null;try{a=new FormData}catch(t){}wfu_BrowserCaps.supportsHTML5=null!=a;var t=document.createElement("iframe");wfu_BrowserCaps.supportsIFRAME=null!=t,wfu_BrowserCaps.supportsDRAGDROP=!!window.FileReader,wfu_BrowserCaps.supportsAnimation=wfu_check_animation(),wfu_BrowserCaps.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0}}function wfu_check_animation(){var e=!1,a="Webkit Moz O ms Khtml".split(" "),t=document.createElement("DIV");if(t.style.animationName&&(e=!0),!1===e)for(var r=0;r<a.length;r++)if(void 0!==t.style[a[r]+"AnimationName"]){a[r].toLowerCase(),e=!0;break}return e}function wfu_join_strings(e){for(var a=[].slice.call(arguments),t="",r=1;r<a.length;r++)t+=(""==t||""==a[r]?"":e)+a[r];return t}function wfu_plugin_decode_string(e){for(var a,t,r=0,s="";r<e.length;)t=(a=parseInt(e.substr(r,2),16))<128?a:a<224?((31&a)<<6)+(63&parseInt(e.substr(r+=2,2),16)):((15&a)<<12)+((63&parseInt(e.substr(r+=2,2),16))<<6)+(63&parseInt(e.substr(r+=2,2),16)),s+=String.fromCharCode(t),r+=2;return s}function wfu_plugin_encode_string(e){var a=0,t="",r="";for(a=0;a<e.length;a++)num=e.charCodeAt(a),num>=2048?num=((16773120&num|917504)<<4)+((4032&num|8192)<<2)+(63&num|128):num>=128&&(num=((65472&num|12288)<<2)+(63&num|128)),1!=(r=num.toString(16)).length&&3!=r.length&&5!=r.length||(r="0"+r),t+=r;return t}function wfu_decode_array_from_string(e){var a=wfu_plugin_decode_string(e),t=null;try{t=JSON.parse(a)}catch(e){}return t}function wfu_randomString(e){for(var a=e,t="",r=0;r<a;r++){var s=Math.floor(61*Math.random());t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(s,s+1)}return t}function wfu_addEventHandler(e,a,t){e.addEventListener?e.addEventListener(a,t,!1):e.attachEvent?e.attachEvent("on"+a,t):e["on"+a]=t}function wfu_attach_element_handlers(e,a){for(var t=["DOMAttrModified","textInput","input","change","keypress","paste","focus","propertychange"],r=0;r<t.length;r++)wfu_addEventHandler(e,t[r],a)}function wfu_GetHttpRequestObject(){var e=null;try{e=new XMLHttpRequest}catch(a){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}if(null==e&&window.createRequest)try{xmlhttp=window.createRequest()}catch(e){}return e}function wfu_get_filelist(e,a){var t=GlobalData.WFU[e];a=void 0===a||a;var r=[];return t.uploadform_exist&&(r=t.uploadform.files()),a&&void 0!==t.filearray&&(r=t.filearray),r}function wfu_add_files(e,a){var t=GlobalData.WFU[e];void 0===t.filearray&&(t.filearray=Array(),t.filearrayprops=Array()),t.uploadform_exist&&t.uploadform.reset(),t.filearray.length=t.filearrayprops.length=0;for(var r=0;r<a.length;r++)t.filearray.push(a[r].file),t.filearrayprops.push(a[r].props)}function wfu_attach_cancel_event(e,a){function t(){var a=wfu_Initialize_Params();a.general.shortcode_id=e,a.general.unique_id="",a.general.files_count=0,a.general.state=16,wfu_ProcessUploadComplete(e,0,a,"no-ajax","",[!1,null,!1]),r.uploadform_exist&&(r.uploadform.reset(),r.uploadform.submit(),r.uploadform.lock())}var r=GlobalData.WFU[e];r.textbox_exist&&r.textbox.attachCancelHandler((function(){var s=!1;if(r.is_formupload)1==(s=confirm(GlobalData.consts.cancel_upload_prompt))&&function(){var r=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_cancel_upload&wfu_uploader_nonce="+wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)+"&sid="+e+"&unique_id="+a+"&session_token="+GlobalData.WFU[e].session,s=wfu_GetHttpRequestObject();if(null==s){var o=document.createElement("iframe");if(o)return o.style.display="none",o.src=r,document.body.appendChild(o),void(o.onload=function(){t()})}s.open("GET",r,!0),s.onreadystatechange=function(){4==s.readyState&&200==s.status&&t()},s.send(null)}();else{if(!GlobalData[e]||0==GlobalData[e].xhrs.length)return!1;if(1==(s=confirm(GlobalData.consts.cancel_upload_prompt))){for(var o=wfu_get_filelist(e),n=[],i=[],l=0;l<o.length;l++)n.push(null),i.push(o[l].name);for(l=0;l<GlobalData[e].xhrs.length;l++){var u=GlobalData[e].xhrs[l].file_id-1;u>=0&&null==n[u]&&(n[u]=GlobalData[e].xhrs[l])}for(r.debugmode&&console.log("upload cancelled!"),l=0;l<n.length;l++)if(null==n[l]&&(n[l]=wfu_GetHttpRequestObject(),null!=n[l]&&wfu_initialize_fileupload_xhr(n[l],e,a,l,i[l])),-1!=n[l]){var d={target:{responseText:"force_cancel_code",shortcode_id:e}};wfu_uploadComplete.call(n[l],d)}}}return s}))}function wfu_dettach_cancel_event(e){var a=GlobalData.WFU[e];a.textbox_exist&&a.textbox.dettachCancelHandler()}function wfu_selectbutton_changed(e,a){wfu_BrowserCaps.supportsAJAX&&wfu_BrowserCaps.supportsHTML5||(a=0);var t=wfu_get_filelist(e,!1);if(1==a){void 0===GlobalData.WFU[e].filearray&&(GlobalData.WFU[e].filearray=Array());for(var r=0;r<t.length;r++)GlobalData.WFU[e].filearray.push(t[r])}else void 0!==GlobalData.WFU[e].filearray&&delete GlobalData.WFU[e].filearray;wfu_update_filename_text(e),wfu_webcam_update_preview(e)}function wfu_selectbutton_clicked(e){var a=GlobalData.WFU[e];a.message_exist&&a.message.reset(),a.uploadform_exist&&a.uploadform.reset()}function wfu_update_uploadbutton_status(e){var a=GlobalData.WFU[e];if(a.submit_exist){var t=a.submit,r=wfu_get_filelist(e).length>0||a.allownofile;r=wfu_Code_Objects[e].apply_filters("uploadbutton_status",r),t.toggle(r)}}function wfu_update_filename_text(e){var a=GlobalData.WFU[e];if(a.textbox_exist){for(var t=wfu_get_filelist(e),r=[],s=0;s<t.length;s++)r.push(t[s].name);a.textbox.update("set",r)}}function wfu_init_userdata_handlers(e,a){var t=GlobalData.WFU[e],r=t.userdata.props[a],s=t.userdata.codes[a],o=t.userdata;s.init=function(){},s.value=function(){return""},s.lock=function(){},s.unlock=function(){},s.reset=function(){},s.empty=function(){return""},s.validate=null,s.typehook=null,"text"==r.type||"multitext"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}):"number"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.typehook?s.typehook(e):r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){var e=/^(\+|\-)?[0-9]*$/i;return"f"==r.format&&(e=/^(\+|\-)?[0-9]*?\.?[0-9]*$/i),e.test(o.getValue(r))?"":o.error_invalid_number},s.typehook=function(e){var a=/^(\+|\-)?[0-9]*$/i;"f"==r.format&&(a=/^(\+|\-)?[0-9]*?\.?[0-9]*$/i),a.test(e.target.value)?r.store():e.target.value=r.getstored()}):"email"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){return""==o.getValue(r)||/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(o.getValue(r))?"":o.error_invalid_email}):"confirmemail"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){for(var e=null,a=0;a<t.userdata.props.length;a++)if(t.userdata.props[a]&&"email"==t.userdata.props[a].type&&t.userdata.props[a].group==r.group){e=t.userdata.props[a];break}return null!=e?o.getValue(r)==o.getValue(e)?"":o.error_confirm_email_nomatch:o.error_confirm_email_nobase}):"password"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}):"confirmpassword"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""},s.validate=function(){for(var e=null,a=0;a<t.userdata.props.length;a++)if(t.userdata.props[a]&&"password"==t.userdata.props[a].type&&t.userdata.props[a].group==r.group){e=t.userdata.props[a];break}return null!=e?o.getValue(r)==o.getValue(e)?"":o.error_confirm_password_nomatch:o.error_confirm_password_nobase}):"checkbox"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)?"true":"false"},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,"true"==r.default),r.store()},s.empty=function(){return o.getValue(r)?"":o.error_checkbox_notchecked}):"radiobutton"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_radio_notselected:""}):"date"==r.type||"time"==r.type||"datetime"==r.type?(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){def=r.default.trim(),"("==def.substr(0,1)&&")"==def.substr(def.length-1,1)?def=def.substr(1,def.length-2):def="",o.setValue(r,def),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}):("list"==r.type||"dropdown"==r.type||"honeypot"==r.type)&&(s.init=function(){o.initField(r),o.attachHandlers(r,(function(e){r.store()}))},s.value=function(){return o.getValue(r)},s.lock=function(){o.disable(r)},s.unlock=function(){o.enable(r)},s.reset=function(){o.setValue(r,r.default),r.store()},s.empty=function(){return""===o.getValue(r)?o.error_empty:""}),s.init()}function wfu_Redirect(e){window.location=e}function wfu_loadStart(e){}function wfu_update_upload_metrics(e){for(var a=0,t=0,r=0,s=Array(),o=wfu_get_filelist(e),n=0;n<o.length;n++)s[n]={size:o[n].size,aborted:!1,loaded:0,delta:0};for(n=0;n<GlobalData[e].xhrs.length;n++)(i=GlobalData[e].xhrs[n].file_id)>0&&GlobalData[e].xhrs[n].aborted&&s[i-1]&&(s[i-1].aborted=!0);for(n=0;n<GlobalData[e].xhrs.length;n++){var i;(i=GlobalData[e].xhrs[n].file_id)>0&&s[i-1]&&!s[i-1].aborted?(s[i-1].size=Math.max(GlobalData[e].xhrs[n].totalsize,s[i-1].size),s[i-1].loaded+=GlobalData[e].xhrs[n].sizeloaded,s[i-1].delta+=Math.max(GlobalData[e].xhrs[n].deltaloaded,0)):i>0&&s[i-1]&&s[i-1].aborted&&(s[i-1].hasOwnProperty("abort_metrics")||(s[i-1].abort_metrics={size:o[i-1].size,loaded:0,delta:0}),s[i-1].abort_metrics.size=Math.max(GlobalData[e].xhrs[n].totalsize,s[i-1].abort_metrics.size),s[i-1].abort_metrics.loaded+=GlobalData[e].xhrs[n].sizeloaded,s[i-1].abort_metrics.delta+=Math.max(GlobalData[e].xhrs[n].deltaloaded,0))}var l=(new Date).getTime();for(n=0;n<o.length;n++){var u=GlobalData[e].metrics[n];!s[n].aborted&&s[n].size>0?(u.size=s[n].size,"incremental"==GlobalData.consts.wfu_uploadprogress_mode?u.size-u.loaded!=0?u.progress_pos=Math.min(u.progress_pos+(1-u.progress_pos)*s[n].delta/(u.size-u.loaded),1):u.progress_pos=1:u.progress_pos=s[n].loaded/s[n].size,u.loaded=s[n].loaded,u.last_time=l,a+=u.size,t+=u.loaded,r+=s[n].delta):(u.size=0,u.progress_pos=0,u.loaded=0,s[n].aborted&&s[n].size>0&&!u.hasOwnProperty("abort_metrics")&&(u.last_time=0,u.aborted=!0,u.abort_metrics={size:s[n].abort_metrics.size,loaded:s[n].abort_metrics.loaded,abort_time:l}))}(u=GlobalData[e].metricstotal).size=a,"incremental"==GlobalData.consts.wfu_uploadprogress_mode?u.size-u.loaded!=0?u.progress_pos=Math.min(u.progress_pos+(1-u.progress_pos)*r/(u.size-u.loaded),1):u.progress_pos=1:u.progress_pos=t/a,u.loaded=t,u.last_time=l}function wfu_uploadProgress(e,a,t,r){var s=GlobalData.WFU[a];r&&void 0===this.xhr&&(console.log("total="+e.total+", loaded="+e.loaded),console.log(e));var o=GlobalData[a].xhrs[t];if(0!=o.file_id){var n=0,i=!!s.progressbar_exist;if(e.lengthComputable){if(o.deltaloaded=e.loaded-o.sizeloaded,o.sizeloaded=e.loaded,o.size<e.total&&e.total>0){n=e.total-o.size,o.deltasize+=n,o.size+=n;for(var l=0;l<GlobalData[a].xhrs.length;l++)GlobalData[a].xhrs[l].file_id==o.file_id&&(GlobalData[a].xhrs[l].totalsize+=n)}wfu_update_upload_metrics(a),o.deltaloaded=0;var u=Math.round(100*GlobalData[a].metricstotal.progress_pos);wfu_Code_Objects[a].do_action("update_total_progress",u),i&&s.progressbar.update(u)}else wfu_Code_Objects[a].do_action("update_total_progress",0),i&&s.progressbar.update(0)}}function wfu_notify_WPFilebase(e,a){var t=wfu_GetHttpRequestObject();if(null==t)return(o=document.createElement("iframe")).style.display="none",o.src=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_notify_wpfilebase&params_index="+e+"&session_token="+a,void document.body.appendChild(o);var r=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_notify_wpfilebase",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=e,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=a;for(var s="",o=0;o<params.length;o++)s+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);t.open("POST",r,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){},t.send(s)}function wfu_send_email_notification(e,a){var t=GlobalData.WFU[e],r=wfu_GetHttpRequestObject();if(null!=r){var s=GlobalData.consts.ajax_url;params=new Array(4),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_send_email_notification",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=t.params_index,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=t.session,params[3]=new Array(2),params[3][0]="uniqueuploadid_"+e,params[3][1]=a;for(var o="",n=0;n<params.length;n++)o+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);wfu_initialize_fileupload_xhr(r,e,a,-1,""),r.success_message_header="",r.error_message_header="",r.error_adminmessage_unknown="",r.open("POST",s,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.addEventListener("load",wfu_uploadComplete,!1),r.addEventListener("error",wfu_uploadFailed,!1),r.addEventListener("abort",wfu_uploadCanceled,!1),r.send(o)}}function wfu_uploadComplete(e){var a=new Date,t=this.shortcode_id,r=GlobalData.WFU[t],s=(this.file_id,!1),o="",n="",i="",l="unknown",u=null;this.loading=!1,this.end_time=a.getTime();var d=e.target.responseText,_=d,c="error";if(-1!=d&&(d.indexOf("force_errorabort_code")>-1&&(c="errorabort",d=d.replace("force_errorabort_code","")),d.indexOf("force_cancel_code")>-1&&(c="errorcancel",d=d.replace("force_cancel_code","")),d.indexOf("force_abortsuccess_code")>-1&&(c="errorabortsuccess",d=d.replace("force_abortsuccess_code",""))),-1!=d){var f=d.indexOf("wfu_fileupload_success:"),p="";if(f>-1&&(r.debugmode&&(p=d.substr(0,f)),f=(_=d.substr(f+23)).indexOf(":"),o=_.substr(0,f),f=(_=_.substr(f+1)).indexOf(":"),i=_.substr(0,f),n=_.substr(f+1)),""!=p){var m="";"fileupload"==this.requesttype?m="Debug Data - File: "+this.file_id:"email"==this.requesttype&&(m="Debug Data - Email Notification"),u={title:m,data:p}}if(""!=i){var g=i.split(";");if(1==parseInt(g[2])){var b=g[3].split(",");l=wfu_plugin_decode_string(b[0]),b[4]}}}if(""==n||""==i){var w=wfu_Initialize_Params();w.general.shortcode_id=t,w.general.unique_id=this.unique_id,w.general.state=7,w.general.files_count="fileupload"==this.requesttype?1:0,w.general.upload_finish_time=this.finish_time;var h=r.fail_colors.split(","),v=this.error_message_header,G=c;"errorabortsuccess"==c?(w.general.fail_message="",w.general.fail_admin_message="",h=r.success_colors.split(","),v=this.success_message_header,G="success"):"errorcancel"!=c?(w.general.fail_message=GlobalData.consts.message_unknown,w.general.fail_admin_message=wfu_join_strings("<br />",this.error_adminmessage_unknown,this.requesttype+":"+_)):(w.general.fail_message=GlobalData.consts.file_cancelled,w.general.fail_admin_message=""),w.general.files_count>0?(w[0]={},w[0].color=h[0],w[0].bgcolor=h[1],w[0].borcolor=h[2],w[0].message_type=G,l=c,w[0].header=v,w[0].message=GlobalData.consts.message_timelimit,w[0].admin_messages=r.is_admin?GlobalData.consts.message_admin_timelimit:""):w.general.admin_messages.other=r.is_admin?GlobalData.consts.message_admin_timelimit:"",w.general.upload_finish_time>0&&a.getTime()<w.general.upload_finish_time&&(w.general.files_count>0?(w[0].message=w.general.fail_message,w[0].admin_messages=r.is_admin?w.general.fail_admin_message:""):w.general.admin_messages.other=r.is_admin?w.general.fail_admin_message:"")}if(""==n||""==i?(r.debugmode&&console.log("wfu_ProcessUploadComplete: ",t,this.file_id,"Params obj",this.unique_id,"",[r.debugmode,u,r.is_admin],this.requesttype,""),s=wfu_ProcessUploadComplete(t,this.file_id,w,this.unique_id,"",[r.debugmode,u,r.is_admin],this.requesttype,"")):(r.debugmode&&console.log("wfu_ProcessUploadComplete: ",t,this.file_id,"Params str",this.unique_id,i,[r.debugmode,u,r.is_admin],this.requesttype,o),s=wfu_ProcessUploadComplete(t,this.file_id,n,this.unique_id,i,[r.debugmode,u,r.is_admin],this.requesttype,o)),s&&(wfu_dettach_cancel_event(t),wfu_unlock_upload(t),r.progressbar_exist&&r.progressbar.hide(),wfu_clear(t)),e.target.return_status)return l}function wfu_ProcessUploadComplete(sid,file_id,upload_params,unique_id,safe_output,debug_data,request_type,js_script_enc){var WFU=GlobalData.WFU[sid];if(sid&&!(sid<0)&&null!=upload_params&&""!=upload_params&&""!=unique_id&&("no-ajax"==unique_id||GlobalData[sid])){var do_redirect=!1;if("string"==typeof upload_params){upload_params=wfu_plugin_decode_string(upload_params.replace(/^\s+|\s+$/g,""));var Params=null;try{Params=JSON.parse(upload_params)}catch(e){}if(null==Params){var safe_parts=safe_output.split(";");Params=wfu_Initialize_Params(),Params.general.shortcode_id=sid,Params.general.unique_id=unique_id,Params.general.state=safe_parts[0],4==Params.general.state&&Params.general.state++;var default_colors=safe_parts[1].split(","),filedata="",error_jsonparse_filemessage=GlobalData.consts.jsonparse_filemessage,error_jsonparse_message=GlobalData.consts.jsonparse_message,error_jsonparse_adminmessage=GlobalData.consts.jsonparse_adminmessage;Params.general.files_count=parseInt(safe_parts[2]);for(var i=0;i<Params.general.files_count;i++)Params[i]={},Params[i].color=default_colors[0],Params[i].bgcolor=default_colors[1],Params[i].borcolor=default_colors[2],filedata=safe_parts[i+3].split(","),Params[i].message_type=wfu_plugin_decode_string(filedata[0]),Params[i].header=wfu_plugin_decode_string(filedata[1]),"success"==Params[i].message_type&&(Params[i].header+=error_jsonparse_filemessage,Params[i].message_type="warning"),Params[i].message=wfu_join_strings("<br />",error_jsonparse_message,wfu_plugin_decode_string(filedata[2])),Params[i].admin_messages=wfu_join_strings("<br />",error_jsonparse_adminmessage,wfu_plugin_decode_string(filedata[3]))}}else{if("object"!=typeof upload_params)return;var Params=upload_params}WFU.debugmode&&console.log("wfu_ProcessUploadComplete debug: ",debug_data),WFU.debugmode&&console.log("wfu_ProcessUploadComplete Params: ",Params);var message_types=[];for(i=0;Params[i];)Params[i].message_type&&(message_types.push(Params[i].message_type),"error"==Params[i].message_type.substr(0,5)&&(Params[i].message_type=Params[i].message_type.substr(0,5))),i++;GlobalData[sid]||(GlobalData[sid]=Object());var G=GlobalData[sid];if("no-ajax"==unique_id)G.last=!1,G.unique_id="",G.files_count=Params.general.files_count,0==Params.general.state&&(Params.general.files_count=0),G.files_processed=Params.general.files_count,G.upload_state=Params.general.state,G.nofileupload=Params.general.state>12&&Params.general.state<16,"message"in G||(G.message=[]),""!=Params.general.message?G.message.push(Params.general.message):G.message=[],G.update_wpfilebase=Params.general.update_wpfilebase,G.redirect_link=Params.general.redirect_link,G.notify_by_email=0,G.admin_messages={},G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase,G.admin_messages.notify=Params.general.admin_messages.notify,G.admin_messages.redirect=Params.general.admin_messages.redirect,"debug"in G.admin_messages||(G.admin_messages.debug=[]),null!==debug_data[1]&&G.admin_messages.debug.push(debug_data[1]),"other"in G.admin_messages||(G.admin_messages.other=[]),""!=Params.general.admin_messages.other&&G.admin_messages.other.push(Params.general.admin_messages.other),G.errors={},G.errors.wpfilebase=Params.general.errors.wpfilebase,G.errors.notify=Params.general.errors.notify,G.errors.redirect=Params.general.errors.redirect,G.current_size=0,G.total_size=0;else{if(""==G.unique_id||G.unique_id!=unique_id||G.unique_id!=Params.general.unique_id)return;if(G.last)return;0==Params.general.files_count&&Params[0]&&"error"==Params[0].message_type&&(Params.general.files_count=1);for(var file_status="",i=0;i<Params.general.files_count;i++)file_status="error"==Params[i].message_type&&0==G.files_processed?"error1":"error"==Params[i].message_type&&G.files_processed>0?"error2":Params[i].message_type,G.upload_state=GlobalData.filestatematch[file_status][G.upload_state];G.files_processed+=Params.general.files_count,""!=Params.general.message&&G.message.push(Params.general.message),""==G.update_wpfilebase&&(G.update_wpfilebase=Params.general.update_wpfilebase),(!request_type||request_type&&"email"!=request_type)&&(G.redirect_link=Params.general.redirect_link),G.notify_by_email+=parseInt("0"+Params.general.notify_by_email),null!==debug_data[1]&&G.admin_messages.debug.push(debug_data[1]),""!=Params.general.admin_messages.other&&G.admin_messages.other.push(Params.general.admin_messages.other),""==G.admin_messages.wpfilebase&&(G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase),""==G.admin_messages.notify&&(G.admin_messages.notify=Params.general.admin_messages.notify),""==G.admin_messages.redirect&&(G.admin_messages.redirect=Params.general.admin_messages.redirect),""==G.errors.wpfilebase&&(G.errors.wpfilebase=Params.general.errors.wpfilebase),""==G.errors.notify&&(G.errors.notify=Params.general.errors.notify),""==G.errors.redirect&&(G.errors.redirect=Params.general.errors.redirect)}G.files_processed==G.files_count&&(G.last=!0,""!=G.update_wpfilebase&&(G.admin_messages.wpfilebase="",wfu_notify_WPFilebase(WFU.params_index,WFU.session)),G.notify_by_email>0&&(G.admin_messages.notify="",wfu_send_email_notification(sid,unique_id),G.last=!1,G.notify_by_email=0),G.last&&(GlobalData[sid].metricstotal&&(GlobalData[sid].metricstotal.end_time=(new Date).getTime()),"no-ajax"==unique_id||G.nofileupload||wfu_notify_server_upload_ended(sid,unique_id),GlobalData.UploadInProgressString=GlobalData.UploadInProgressString.replace(new RegExp("\\["+unique_id+"\\]","g"),"")),""!=G.errors.redirect&&(G.redirect_link=""),""!=G.redirect_link&&G.last&&""==GlobalData.UploadInProgressString.trim()&&(G.upload_state=11,do_redirect=!0));var nonadmin_message=G.message,admin_message=[].concat(G.admin_messages.other,""!=G.admin_messages.wpfilebase?[G.admin_messages.wpfilebase]:[],""!=G.admin_messages.notify?[G.admin_messages.notify]:[],""!=G.admin_messages.redirect?[G.admin_messages.redirect]:[]);if(G.last&&(G.nofileupload?("no-ajax"!=unique_id&&(0==G.upload_state?G.upload_state=14:G.upload_state<4&&(G.upload_state=15)),15==G.upload_state&&Params[0]&&(nonadmin_message.push(Params[0].message),admin_message.push(Params[0].admin_messages))):(G.files_count>0&&G.store_nothing&&G.upload_state<3&&(G.upload_state=19),0==G.files_count&&12!=G.upload_state&&G.upload_state<16?G.upload_state=8:G.upload_state<4&&(G.upload_state+=4),4==G.upload_state&&admin_message.length>0?G.upload_state++:5==G.upload_state&&0==admin_message.length&&0==nonadmin_message.length&&G.upload_state--)),WFU.message_exist){var suffix="";1!=G.files_count||5!=G.upload_state&&7!=G.upload_state||(suffix="_singlefile");for(var final_upload_state=0==G.upload_state&&G.nofileupload?13:G.upload_state,data={files_count:G.nofileupload?0:G.files_count,files_processed:G.nofileupload?0:G.files_processed,state:final_upload_state,single:1==G.files_count&&0==nonadmin_message.length&&0==admin_message.length&&G.last&&!do_redirect&&!G.nofileupload,color:GlobalData.States["State"+final_upload_state+suffix].color,bgcolor:GlobalData.States["State"+final_upload_state+suffix].bgcolor,borcolor:GlobalData.States["State"+final_upload_state+suffix].borcolor,message1:GlobalData.States["State"+final_upload_state+suffix].message,message2:nonadmin_message,message3:admin_message,debug_data:G.admin_messages.debug,files:[]},i=0;i<Params.general.files_count;i++)data.files[i]={index:i+file_id,result:Params[i].message_type,message1:Params[i].header,message2:Params[i].message,message3:Params[i].admin_messages};WFU.message.update(data)}return js_script_enc&&eval(wfu_plugin_decode_string(js_script_enc)),do_redirect&&wfu_Redirect(G.redirect_link),G.last}}function wfu_uploadFailed(e,a){a&&(console.log("failure report following"),console.log(e));var t=e.target,r={target:{responseText:"",shortcode_id:t.shortcode_id}};wfu_uploadComplete.call(t,r)}function wfu_uploadCanceled(e){}function wfu_notify_server_upload_ended(e,a){var t=GlobalData.WFU[e],r=wfu_GetHttpRequestObject();if(null!=r){var s=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action",params[1]=new Array(2),params[1][0]="wfu_uploader_nonce",params[1][1]=wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e),params[2]=new Array(2),params[2][0]="uniqueuploadid_"+e,params[2][1]=a,params[3]=new Array(2),params[3][0]="params_index",params[3][1]=t.params_index,params[4]=new Array(2),params[4][0]="session_token",params[4][1]=t.session,params[5]=new Array(2),params[5][0]="upload_finished",params[5][1]=1;for(var o="",n=0;n<params.length;n++)o+=(n>0?"&":"")+params[n][0]+"="+encodeURI(params[n][1]);r.open("POST",s,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){4==r.readyState&&200==r.status&&wfu_Code_Objects[e].do_action("after_upload",r.responseText)},r.send(o)}}function wfu_Initialize_Params(){var e={version:"full",general:{}};return e.general.shortcode_id=0,e.general.unique_id="",e.general.state=0,e.general.files_count=0,e.general.update_wpfilebase="",e.general.redirect_link="",e.general.upload_finish_time=0,e.general.message="",e.general.message_type="",e.general.admin_messages={},e.general.admin_messages.wpfilebase="",e.general.admin_messages.notify="",e.general.admin_messages.redirect="",e.general.admin_messages.other="",e.general.errors={},e.general.errors.wpfilebase="",e.general.errors.notify="",e.general.errors.redirect="",e.general.color="",e.general.bgcolor="",e.general.borcolor="",e.general.notify_by_email=0,e.general.fail_message="",e.general.fail_admin_message="",e}function wfu_redirect_to_classic(e,a,t){var r=GlobalData.WFU[e];r.is_formupload=!0;var s=wfu_filesselected(e);(0!=s||r.allownofile)&&(r.subfolders_exist&&s>0&&!r.subfolders.check()||wfu_check_required_userdata(e,!0)&&wfu_Code_Objects[e].apply_filters("pre_start_check",!0)&&wfu_redirect_to_classic_cont(e,a,t))}function wfu_redirect_to_classic_cont(e,a,t){var r=function(r){var o=GlobalData.WFU[e],n="",i=(o.session,"wfu_askserver_success:"),l=r.indexOf(i),u=r.indexOf("wfu_askserver_error:");if(l>-1){n=r.substr(l+22);var d=wfu_filesselected(e),_=0==d&&o.allownofile;wfu_Code_Objects[e].do_action("askserver_success",n,"no-ajax"),o.progressbar_exist&&!_&&o.progressbar.show("shuffle"),wfu_attach_cancel_event(e,s);var c=wfu_Initialize_Params();c.general.shortcode_id=e,c.general.unique_id="",c.general.files_count=d,_&&(c.general.state=13),wfu_ProcessUploadComplete(e,0,c,"no-ajax","",[!1,null,!1]),wfu_set_stored_formdata(e,"uniqueuploadid_"+e,s),wfu_set_stored_formdata(e,"nofileupload_"+e,_?"1":"0");var f="";1==a&&(f="_redirected"),o.uploadform_exist&&o.uploadform.changeFileName("uploadedfile_"+e+f),wfu_set_stored_formdata(e,"adminerrorcodes_"+e,t>0?t:""),o.uploadform_exist&&(o.uploadform.submit(),o.uploadform.lock())}else u>-1&&(n=r.substr(u+20),wfu_unlock_upload(e),wfu_Code_Objects[e].do_action("askserver_error",n))},s=wfu_randomString(10);wfu_lock_upload(e),wfu_Code_Objects[e].do_action("pre_start");var o="",n=wfu_Code_Objects[e].apply_filters("askserver_pass_params",{});for(var i in n)n.hasOwnProperty(i)&&(o+="&"+i+"="+n[i]);var l=new Date,u=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_ask_server&wfu_uploader_nonce="+wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)+"&sid="+e+"&unique_id="+s+"&start_time="+l.getTime()+"&session_token="+GlobalData.WFU[e].session+o,d=wfu_GetHttpRequestObject();if(null==d){var _=document.createElement("iframe");return _?(_.style.display="none",_.src=u,document.body.appendChild(_),void(_.onload=function(){r(_.contentDocument.body.innerHTML)})):void wfu_Code_Objects[e].do_action("not_supported")}d.open("GET",u,!0),d.onreadystatechange=function(){4==d.readyState&&(200==d.status?r(d.responseText):(alert(GlobalData.consts.remoteserver_noresult),wfu_Code_Objects[e].do_action("askserver_noresult")))},d.send(null)}function wfu_filesselected(e){var a=GlobalData.WFU[e],t=wfu_get_filelist(e);return 0==t.length&&!a.allownofile&&a.textbox_exist&&a.textbox.update("nofile"),t.length}function wfu_get_stored_formdata(e,a){var t=GlobalData.WFU[e];return t.uploadform_exist?t.uploadform.getStoreddata?t.uploadform.getStoreddata(a):document.getElementById(a).value:null}function wfu_set_stored_formdata(e,a,t){var r=GlobalData.WFU[e];if(!r.uploadform_exist)return null;r.uploadform.setStoreddata?r.uploadform.setStoreddata(a,t):document.getElementById(a).value=t}function wfu_check_required_userdata(e,a){for(var t=GlobalData.WFU[e],r=wfu_get_userdata_count(e),s=!1,o=0;o<r;o++){t.userdata.props[o].store();var n="";t.userdata.props[o].required&&(n=t.userdata.codes[o].empty()),""===n&&null!=t.userdata.codes[o].validate&&t.userdata.props[o].validate&&(n=t.userdata.codes[o].validate()),""!==n&&(a&&t.userdata.prompt(t.userdata.props[o],n),s=!0)}return!s}function wfu_HTML5UploadFile(e){var a=GlobalData.WFU[e];if(wfu_BrowserCaps.supportsAJAX)if(wfu_BrowserCaps.supportsHTML5){var t=wfu_GetHttpRequestObject();if(null!=t){var r=wfu_filesselected(e);if(0!=r||a.allownofile)if(0==r&&wfu_selectbutton_clicked(e),a.subfolders_exist&&r>0&&!a.subfolders.check())a.singlebutton&&wfu_clear_files(e);else{var s=r;if(s+=s,wfu_check_required_userdata(e,!0)){if(wfu_Code_Objects[e].apply_filters("pre_start_check",!0)){var o=wfu_randomString(10);if(wfu_lock_upload(e),wfu_Code_Objects[e].do_action("pre_start"),wfu_Code_Objects[e].apply_filters("pre_start_ask_server",!1,a.has_filters?"true":"false")){var n=GlobalData.consts.ajax_url;params=new Array(5),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_ask_server",params[1]=new Array(2),params[1][0]="session_token",params[1][1]=a.session,params[2]=new Array(2),params[2][0]="sid",params[2][1]=e,params[3]=new Array(2),params[3][0]="unique_id",params[3][1]=o,params[4]=new Array(2),params[4][0]="wfu_uploader_nonce",params[4][1]=wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e);var i=wfu_Code_Objects[e].apply_filters("askserver_pass_params",{});for(var l in i)i.hasOwnProperty(l)&&params.push([l,i[l]]);for(var u="",d=0;d<params.length;d++)u+=(d>0?"&":"")+params[d][0]+"="+encodeURI(params[d][1]);t.open("POST",n,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status){var a=t.responseText,r="",s=a.indexOf("wfu_askserver_success:"),n=a.indexOf("wfu_askserver_error:");s>-1?(r=a.substr(s+22),wfu_Code_Objects[e].do_action("askserver_success",r,"ajax"),wfu_HTML5UploadFile_cont(e,o)):n>-1&&(r=a.substr(n+20),wfu_unlock_upload(e),wfu_Code_Objects[e].do_action("askserver_error",r))}else alert(GlobalData.consts.remoteserver_noresult),wfu_unlock_upload(e),wfu_Code_Objects[e].do_action("askserver_noresult")},t.send(u)}else wfu_HTML5UploadFile_cont(e,o)}}else a.singlebutton&&wfu_clear_files(e)}}}else wfu_redirect_to_classic(e,1,2);else wfu_redirect_to_classic(e,1,1)}function wfu_HTML5UploadFile_cont(e,a){var t=GlobalData.WFU[e],r=-1;t.subfolders_exist&&(r=t.subfolders.index());var s=wfu_get_filelist(e),o=!1;0==s.length&&t.allownofile&&(o=!0,s=[{name:"dummy.txt",size:0}]);GlobalData.UploadInProgressString+="["+a+"]",GlobalData[e]={},GlobalData[e].unique_id=a,GlobalData[e].last=!1,GlobalData[e].files_count=1,GlobalData[e].files_processed=0,GlobalData[e].upload_state=0,GlobalData[e].nofileupload=o,GlobalData[e].store_nothing=!!t.consent_exist&&"no"==wfu_get_stored_formdata(e,"consentresult_"+e)&&t.not_store_files,GlobalData[e].message=[],GlobalData[e].update_wpfilebase="",GlobalData[e].redirect_link="",GlobalData[e].notify_by_email=0,GlobalData[e].admin_messages={},GlobalData[e].admin_messages.wpfilebase="",GlobalData[e].admin_messages.notify="",GlobalData[e].admin_messages.redirect="",GlobalData[e].admin_messages.debug=[],GlobalData[e].admin_messages.other=[],GlobalData[e].errors={},GlobalData[e].errors.wpfilebase="",GlobalData[e].errors.notify="",GlobalData[e].errors.redirect="",GlobalData[e].xhrs=Array(),GlobalData[e].metricstotal={size:s[0].size,loaded:0,progress_pos:0,start_time:(new Date).getTime(),last_time:0,end_time:0},GlobalData[e].metrics=[{size:s[0].size,loaded:0,progress_pos:0,start_time:0,last_time:0,end_time:0,aborted:!1}],wfu_Code_Objects[e].do_action("update_total_progress",0),t.progressbar_exist&&!o&&t.progressbar.show("progressive"),wfu_attach_cancel_event(e,a);var n=wfu_Initialize_Params();n.general.shortcode_id=e,n.general.unique_id=a,wfu_ProcessUploadComplete(e,0,n,a,"",[!1,null,!1]);var i=!0;!function n(l,u,d,_){i=!0;var c=wfu_GetHttpRequestObject(),f=wfu_GetHttpRequestObject();if(null!=c&&null!=f){var p=null,m=null;try{p=new FormData,m=new FormData}catch(e){}if(null!=p&&null!=m){p.append("action","wfu_ajax_action"),p.append("wfu_uploader_nonce",wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)),d||p.append("uploadedfile_"+e,u),s[l].isBlob&&p.append("uploadedfile_"+e+"_isblob",1),p.append("uploadedfile_"+e+"_index",l),p.append("uploadedfile_"+e+"_name",wfu_plugin_encode_string(s[l].name)),p.append("uploadedfile_"+e+"_size",s[l].size),p.append("uniqueuploadid_"+e,a),p.append("params_index",t.params_index),p.append("subdir_sel_index",r),p.append("nofileupload_"+e,o?"1":"0"),d?p.append("only_check","1"):p.append("only_check","0"),p.append("session_token",t.session);var g=wfu_Code_Objects[e].apply_filters("upload_pass_params",{},"ajax");for(var b in g)g.hasOwnProperty(b)&&p.append(b,g[b]);for(var w=wfu_get_userdata_count(e),h=0;h<w;h++)p.append("hiddeninput_"+e+"_userdata_"+h,wfu_get_stored_formdata(e,"hiddeninput_"+e+"_userdata_"+h));if(wfu_initialize_fileupload_xhr(c,e,a,l,s[l].name),c.loading=!0,d||(c.size=u.size,c.totalsize=s[l].size),_){m.append("action","wfu_ajax_action"),m.append("wfu_uploader_nonce",wfu_get_stored_formdata(e,"wfu_uploader_nonce_"+e)),m.append("params_index",t.params_index),m.append("session_token",t.session),m.append("force_connection_close","1"),f.open("POST",GlobalData.consts.ajax_url,!1);try{f.send(m)}catch(e){}i=f.responseText.indexOf("success")>-1}if(i)d?(c.addEventListener("load",(function(a){a={target:{responseText:a.target.responseText,shortcode_id:e,return_status:!0}};var t=wfu_uploadComplete.call(c,a);c.file_id=0,(i="success"==t||"warning"==t)&&!o&&n(l,u,!1,!1)}),!1),c.addEventListener("error",(function(e){}),!1),c.open("POST",GlobalData.consts.ajax_url,!0),c.send(p)):(c.upload.xhr=c,c.upload.dummy=1,c.upload.addEventListener("loadstart",wfu_loadStart,!1),c.upload.addEventListener("progress",new Function("evt","wfu_uploadProgress(evt, "+e+", "+c.xhrid+", "+(t.debugmode?"true":"false")+");"),!1),c.addEventListener("load",wfu_uploadComplete,!1),c.addEventListener("error",new Function("evt","wfu_uploadFailed(evt, "+(t.debugmode?"true":"false")+");"),!1),c.addEventListener("abort",wfu_uploadCanceled,!1),c.open("POST",GlobalData.consts.ajax_url,!0),c.send(p));else{var v={target:{responseText:"",shortcode_id:e}};wfu_uploadComplete.call(c,v)}return i}}}(0,s[0],!0,!1)}function wfu_initialize_fileupload_xhr(e,a,t,r,s){var o=GlobalData.WFU[a],n=r>=0?GlobalData[a].xhrs.push(e)-1:-1,i=new Date;e.xhrid=n,e.shortcode_id=a,e.requesttype=r>=0?"fileupload":"email",e.file_id=r+1,e.size=0,e.totalsize=0,e.loading=!1,e.deltasize=0,e.deltaloaded=0,e.sizeloaded=0,e.aborted=!1,e.unique_id=t,e.start_time=i.getTime(),e.end_time=e.start_time,e.finish_time=e.start_time+1e3*parseInt(GlobalData.consts.max_time_limit),e.success_message_header=o.success_header.replace(/%username%/g,"no data"),e.success_message_header=e.success_message_header.replace(/%useremail%/g,"no data"),e.success_message_header=e.success_message_header.replace(/%filename%/g,s),e.success_message_header=e.success_message_header.replace(/%filepath%/g,s),e.error_message_header=o.error_header.replace(/%username%/g,"no data"),e.error_message_header=e.error_message_header.replace(/%useremail%/g,"no data"),e.error_message_header=e.error_message_header.replace(/%filename%/g,s),e.error_message_header=e.error_message_header.replace(/%filepath%/g,s),e.error_message_failed=GlobalData.consts.message_failed,e.error_message_cancelled=GlobalData.consts.message_cancelled,e.error_adminmessage_unknown=GlobalData.consts.adminmessage_unknown.replace(/%username%/g,"no data"),e.error_adminmessage_unknown=e.error_adminmessage_unknown.replace(/%useremail%/g,"no data"),e.error_adminmessage_unknown=e.error_adminmessage_unknown.replace(/%filename%/g,s),e.error_adminmessage_unknown=e.error_adminmessage_unknown.replace(/%filepath%/g,s)}function wfu_get_userdata_count(e){var a=GlobalData.WFU[e],t=0;return a.userdata_exist&&(t=a.userdata.props.length),t}function wfu_lock_upload(e){var a=GlobalData.WFU[e];a.textbox_exist&&a.textbox.update("lock"),a.uploadform_exist&&a.uploadform.lock(),a.subfolders_exist&&a.subfolders.toggle(!1),a.submit_exist&&a.submit.toggle(!1);for(var t=wfu_get_userdata_count(e),r=0;r<t;r++)a.userdata.codes[r].lock();wfu_Code_Objects[e].do_action("lock_upload")}function wfu_unlock_upload(e){var a=GlobalData.WFU[e];a.textbox_exist&&a.textbox.update("unlock"),a.uploadform_exist&&a.uploadform.unlock(),a.subfolders_exist&&a.subfolders.toggle(!0),a.submit_exist&&a.submit.toggle(!0);for(var t=wfu_get_userdata_count(e),r=0;r<t;r++)a.userdata.codes[r].unlock();wfu_Code_Objects[e].do_action("unlock_upload")}function wfu_clear_files(e){var a=GlobalData.WFU[e];a.uploadform_exist&&a.uploadform.reset(),void 0!==a.filearray&&(a.filearray.length=0,a.filearrayprops.length=0),a.textbox_exist&&a.textbox.update("clear"),a.webcam_exist&&wfu_reinitialize_webcam(e)}function wfu_check_reset(e){var a=GlobalData.WFU[e],t=GlobalData[e];return"always"==a.resetmode||"never"!=a.resetmode&&("onsuccess"==a.resetmode?[4,5,6,14].indexOf(t.upload_state)>-1:"onfullsuccess"!=a.resetmode||[4,5,14].indexOf(t.upload_state)>-1)}function wfu_clear(e){var a=GlobalData.WFU[e],t=wfu_check_reset(e);if(wfu_clear_files(e),t){a.subfolders_exist&&a.subfolders.reset();for(var r=wfu_get_userdata_count(e),s=0;s<r;s++)a.userdata.codes[s].reset();a.uploadform_exist&&a.uploadform.resetDummy()}wfu_Code_Objects[e].do_action("clear_upload")}function wfu_invoke_shortcode_editor(e){var a=e.shortcode_id,t=0,r=GlobalData.WFU.n;"wordpress_file_upload_browser"==e.shortcode_tag&&(r=GlobalData.WFUB.n);for(var s=0;s<r.length;s++)r[s]==a&&t++;if(0!=t)if(t>1)alert(GlobalData.consts.same_pluginid);else{var o=wfu_GetHttpRequestObject();if(null!=o){e.visualeditorbutton.update("on_invoke");var n=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_edit_shortcode",params[1]=new Array(2),params[1][0]="upload_id",params[1][1]=a,params[2]=new Array(2),params[2][0]="post_id",params[2][1]=e.post_id,params[3]=new Array(2),params[3][0]="post_hash",params[3][1]=e.post_hash,params[4]=new Array(2),params[4][0]="shortcode_tag",params[4][1]=e.shortcode_tag,params[5]=new Array(2),params[5][0]="widget_id",params[5][1]=e.widgetid?e.widgetid:"";var i="";for(s=0;s<params.length;s++)i+=(s>0?"&":"")+params[s][0]+"="+encodeURI(params[s][1]);o.open("POST",n,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){e.visualeditorbutton.update("on_open");var a=o.responseText.indexOf("wfu_edit_shortcode:");-1==a&&(a=o.responseText.length),o.responseText.substr(0,a);var t=o.responseText.substr(a+19,o.responseText.length-a-19);a=t.indexOf(":");var r=t.substr(0,a);if(txt_value=t.substr(a+1,t.length-a-1),"success"==r){var s=window.open(wfu_plugin_decode_string(txt_value),"_blank");s?s.plugin_window=window:alert(GlobalData.consts.enable_popups)}else"check_page_obsolete"==r&&alert(txt_value)}},o.send(i)}}}GlobalData={},Code_Initializators=[],GlobalData.WFU={n:[]},GlobalData.WFUB={n:[]},GlobalData.filestatematch={},GlobalData.filestatematch.success=[0,1,2,2],GlobalData.filestatematch.warning=[1,1,2,2],GlobalData.filestatematch.error1=[3,3,2,3],GlobalData.filestatematch.error2=[2,2,2,3],GlobalData.UploadInProgressString="",GlobalData.FreeChangeHandler=!1,wfu_Check_Browser_Capabilities(),"undefined"==typeof wfu_js_decode_obj&&(wfu_js_decode_obj=function(e){var a=null;if("window"==e)a=window;else{var t=String.fromCharCode(92),r=e.match(new RegExp("GlobalData("+t+".(WFU|WFUB)"+t+"[(.*?)"+t+"]("+t+".(.*))?)?$"));r&&(a=GlobalData,r[3]&&(a=a[r[2]][r[3]]),r[5]&&(a=a[r[5]]))}return a}),Code_Initializators[Code_Initializators.length]=function(sid){var CBUV_Code_Objects={pre_start_check:function(e){if(!e)return e;var a=this.sid,t=!0;return GlobalData.WFU[a].consent_exist&&("prompt"!=GlobalData.WFU[a].consent.consent_format&&""==wfu_get_stored_formdata(a,"consentresult_"+a)?(alert(GlobalData.consts.wfu_consent_notcompleted),t=!1):"prompt"==GlobalData.WFU[a].consent.consent_format&&(wfu_set_stored_formdata(a,"consentresult_"+a,confirm(GlobalData.WFU[a].consent.consent_question)?"yes":"no"),t=!0),GlobalData.WFU[a].consent.no_rejects_upload&&"no"==wfu_get_stored_formdata(a,"consentresult_"+a)&&(alert(GlobalData.WFU[a].consent_rejection_message),t=!1)),t},pre_start_ask_server:function(e,a){if(e)return e;var t=this.sid,r=GlobalData.WFU[t].consent_maybe_ask_server&&!GlobalData.WFU[t].consent_exist;return"true"==a||r},askserver_pass_params:function(e){for(var a=this.sid,t=wfu_get_filelist(a),r="",s="",o=0;o<t.length;o++)o>0&&(r+=";",s+=";"),r+=wfu_plugin_encode_string(t[o].name),s+=t[o].size;var n=[],i=wfu_get_userdata_count(a);for(o=0;o<i;o++)n.push("_"+wfu_plugin_encode_string(wfu_get_stored_formdata(a,"hiddeninput_"+a+"_userdata_"+o)));return e.filenames=r,e.filesizes=s,e.userdata=n.join(";"),GlobalData.WFU[a].consent_maybe_ask_server&&!GlobalData.WFU[a].consent_exist&&(e.consent_check="1",e.consent_rejection_message=GlobalData.WFU[a].consent_rejection_message),e},askserver_success:function(response,mode){var sid=this.sid,upload_status="success",txt_match=response.match(/CBUVJS\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"";""!=txt_header&&eval(wfu_plugin_decode_string(txt_header))},askserver_error:function(response,mode){var sid=this.sid,upload_status="error",txt_match=response.match(/CBUVJS\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"";if(""!=txt_header&&eval(wfu_plugin_decode_string(txt_header)),txt_match=response.match(/CBUV\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"",""!=txt_header){var Params=wfu_Initialize_Params();GlobalData[sid]={},Params.general.shortcode_id=sid,Params.general.message=txt_header,Params.general.state=12,wfu_ProcessUploadComplete(sid,0,Params,"no-ajax","",[!1,null,!1]),wfu_clear(sid)}},lock_upload:function(){var e=this.sid;GlobalData.WFU[e].consent_exist&&GlobalData.WFU[e].consent.update("lock")},unlock_upload:function(){var e=this.sid;GlobalData.WFU[e].consent_exist&&GlobalData.WFU[e].consent.update("unlock")},clear_upload:function(){var e=this.sid,a=GlobalData.WFU[e];a.consent_exist&&(a.consent.remember_consent?(a.consent.update("clear"),a.consent_exist=!1):a.consent.update("init"))},upload_pass_params:function(e,a){var t=this.sid;return GlobalData.WFU[t].consent_exist&&(e.consent_result=wfu_get_stored_formdata(t,"consentresult_"+t)),e},after_upload:function(response){var sid=this.sid,txt_match=response.match(/CBUVJS\[(.*?)\]/),txt_header=txt_match&&void 0!==txt_match[1]?txt_match[1]:"";""!=txt_header&&eval(wfu_plugin_decode_string(txt_header))}};return CBUV_Code_Objects},Code_Initializators[Code_Initializators.length]=function(e){var a={pre_load:function(e){var a=this.sid,t=GlobalData.WFU[a];t.RR||(t.RR=e=>{let a;return t.R?t.R[e]?a=t.R[e]:console.log("Template "+e+" not loaded yet"):console.log("React not loaded yet when loading "+e),a})}};return a},wfu_create_react_dom=(e,a)=>{var t=("shadow-dom"==a.forceSpecificity?document.getElementById("wordpress_file_upload_block_"+a.ID).dom:document).getElementById(e);a.root=(a.root??[]).concat([t])},wfu_render_react_component=e=>{window.WFUReact?window.WFUReact[e.slot](e):(GlobalData.reactLoadSlots||(GlobalData.reactLoadSlots=[]),GlobalData.reactLoadSlots.push(e))},wfu_initialize_webcam=function(e,a,t,r,s,o,n,i,l,u){"undefined"==typeof wfu_parse_video_width&&(wfu_parse_video_width=function(e){var a=parseInt(e);a>0&&(this.empty=!1,this.video.width={ideal:a})}),"undefined"==typeof wfu_parse_video_height&&(wfu_parse_video_height=function(e){var a=parseInt(e);a>0&&(this.empty=!1,this.video.height={ideal:a})}),"undefined"==typeof wfu_parse_video_aspectratio&&(wfu_parse_video_aspectratio=function(e){var a=parseFloat(e);a>0&&(this.empty=!1,this.video.aspectRatio=a)}),"undefined"==typeof wfu_parse_video_framerate&&(wfu_parse_video_framerate=function(e){var a=parseFloat(e);a>0&&(this.empty=!1,this.video.frameRate=a)}),"undefined"==typeof wfu_parse_video_facingmode&&(wfu_parse_video_facingmode=function(e){var a="front"==e?"user":"back"==e?"environment":"";""!=a&&(this.empty=!1,this.video.facingMode=a)});var d={empty:!0,video:{}};wfu_parse_video_width.call(d,r),wfu_parse_video_height.call(d,s),wfu_parse_video_aspectratio.call(d,o),wfu_parse_video_framerate.call(d,n),wfu_parse_video_facingmode.call(d,i);var _={mode:a,audio:"true"==t,video:!!d.empty||d.video,maxrecordtime:l};if(GlobalData.WFU[e].webcamProps=_,u??=!1,u){wfu_webcam_init_callback(e);var c=GlobalData.WFU[e].webcam;c.initButtons(a),c.updateStatus("off")}else wfu_reinitialize_webcam(e)},wfu_reinitialize_webcam=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;t.active=!0,t.width=0,t.height=0,t.timeStart=0,t.duration=0,t.counting=!1,t.stream=null,t.media=null,t.blobs=null,t.playing=!1;var r=t;a.updateStatus("idle");var s={audio:r.audio,video:r.video};"undefined"==typeof Promise&&(Promise=function(e){this.mainCallback=e,this.then=function(e){return this.successCallback=e,this},this.catch=function(a){e(this.successCallback,a)}},PromiseRejected=function(e){this.then=function(e){return this},this.catch=function(a){a(e)}},Promise.reject=function(e){return new PromiseRejected(e)}),void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e,a,t){var r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return r&&"undefined"!=typeof MediaRecorder?new Promise((function(a,t){r.call(navigator,e,a,t)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia(s).then((function(s){t.stream=s,a.setVideoProperties({autoplay:!0,ontimeupdate:null,onerror:null,onloadeddata:function(a){wfu_webcam_init_callback(e)},srcObject:s}),a.initButtons(r.mode)})).catch((function(e){console.log("Video not supported!",e),a.updateStatus("video_notsupported")}))},wfu_webcam_init_callback=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps,r=a.videoSize();t.width=r.width,t.height=r.height,a.initCallback()},wfu_webcam_counter_status=function(e,a){var t=GlobalData.WFU[e].webcamProps;if("start"==a){var r=new Date;t.duration=0,t.timeStart=r.getTime()/1e3,t.counting=!0,wfu_webcam_update_counter(e)}else r=new Date,t.duration=r.getTime()/1e3-t.timeStart,t.counting=!1},wfu_webcam_update_counter=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;if(t.counting){var r=(new Date).getTime()/1e3-t.timeStart;a.updateTimer(r),setTimeout((function(){wfu_webcam_update_counter(e)}),100)}},wfu_webcam_video_devices=function(e){return GlobalData.WFU[e].webcamProps,navigator.mediaDevices?.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((e=>{var a=[];return e.forEach((e=>{"videoinput"==e.kind&&a.push(e.deviceId)})),0==a.length&&(a=null),a})).catch((e=>(console.error(`${e.name}: ${e.message}`),null))):new Promise((e=>e(null)))},wfu_webcam_switch_devices=function(e){var a=GlobalData.WFU[e].webcamProps;!0===a.video&&(a.video={}),wfu_webcam_video_devices(e).then((t=>{if(null!=t&&t.length>0){if(a.videoDeviceId){var r=t.indexOf(a.videoDeviceId)+1;r>=t.length&&(r=0),a.videoDeviceId=t[r]}else a.videoDeviceId=t[0];a.video.deviceId=a.videoDeviceId,wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e)}else wfu_webcam_switch(e)}))},wfu_webcam_switch=function(e){var a=GlobalData.WFU[e].webcamProps;!0===a.video&&(a.video={});var t=null;a.video.facingMode&&(t=a.video.facingMode),a.video.facingMode="environment"==t?"user":"environment",wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e)},wfu_webcam_reset_stream=function(e){var a=GlobalData.WFU[e].webcamProps;null!=a.stream&&a.stream.getTracks&&a.stream.getTracks().forEach((function(e){e.stop()}))},wfu_webcam_onoff=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;t.active?(a.updateStatus("off"),wfu_webcam_reset_stream(e),t.stream=null,t.media=null,t.blobs=null,t.active=!1):(wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e)),wfu_selectbutton_clicked(e)},wfu_webcam_golive=function(e){GlobalData.WFU[e].webcamProps.playing||(wfu_webcam_reset_stream(e),wfu_reinitialize_webcam(e),wfu_add_files(e,[],!1),wfu_selectbutton_clicked(e),wfu_update_uploadbutton_status(e))},wfu_webcam_start_rec=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;if(!t.media||!t.media.state||"recording"!=t.media.state){var r=wfu_mediarecorder_mimetype(e);if(null!=r){try{t.media=new MediaRecorder(t.stream,{mimeType:r})}catch(e){return void alert(GlobalData.consts.webcam_video_notsupported)}t.blobs=[],t.media.ondataavailable=function(a){var r=(new Date).getTime()/1e3-t.timeStart;-1==t.maxrecordtime||t.maxrecordtime>0&&r<=t.maxrecordtime?a.data&&a.data.size>0&&t.blobs.push(a.data):wfu_webcam_stop_rec(e)},a.updateButtonStatus("recording"),wfu_webcam_counter_status(e,"start"),t.media.onstop=function(t){wfu_webcam_counter_status(e,"stop"),a.updateButtonStatus("after_recording"),wfu_webcam_onstop(t,e)},t.media.start(10)}else alert(GlobalData.consts.webcam_video_notsupported)}},wfu_webcam_stop_rec=function(e){GlobalData.WFU[e].webcamProps.media.stop()},wfu_webcam_onstop=function(e,a){var t=GlobalData.WFU[a].webcam,r=GlobalData.WFU[a].webcamProps;if(0==r.blobs.length)alert(GlobalData.consts.webcam_video_nothingrecorded),wfu_webcam_golive(a);else{r.stream&&t.screenshot();var s=new Blob(r.blobs,{type:"video/mp4"});t.setVideoProperties({autoplay:!!/iPad|iPhone|iPod/.test(navigator.userAgent),ontimeupdate:function(e){wfu_webcam_update_pos(a)},onended:function(e){wfu_webcam_ended(a)},onloadeddata:function(e){wfu_webcam_pause(a),t.readyState()>=2&&t.updateButtonStatus("ready_playback")},onerror:function(e){t.setVideoProperties({onloadeddata:null,srcObject:r.stream})},srcObject:s}),s.name="videostream.mp4",s.isBlob=!0,wfu_add_files(a,[{file:s,props:{}}],!1),wfu_update_filename_text(a),wfu_update_uploadbutton_status(a)}},wfu_webcam_play=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;t.playing||(a.updateButtonStatus("playing"),t.playing=!0,a.play())},wfu_webcam_ended=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.ended(),a.updateButtonStatus("ready_playback"),t.playing=!1},wfu_webcam_pause=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.pause(),a.updateButtonStatus("ready_playback"),t.playing=!1},wfu_webcam_back=function(e){GlobalData.WFU[e].webcam.back()},wfu_webcam_fwd=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.fwd(t.duration)},wfu_webcam_update_preview=function(e){if(GlobalData.WFU[e].webcam_exist){var a=wfu_get_filelist(e);0!=a&&GlobalData.WFU[e].webcam.updateImage(a[0])}},wfu_webcam_take_picture=function(e){var a=GlobalData.WFU[e].webcam;GlobalData.WFU[e].webcamProps.stream&&(a.screenshot((function(a){a.name="screenshot.png",a.isBlob=!0,wfu_add_files(e,[{file:a,props:{}}],!1),wfu_update_filename_text(e),wfu_update_uploadbutton_status(e)}),"image/png"),a.updateButtonStatus("after_screenshot"))},wfu_webcam_screenshot_error=function(e){GlobalData.WFU[e].webcam.initButtons(GlobalData.WFU[e].webcamProps.mode)},wfu_webcam_update_pos=function(e){var a=GlobalData.WFU[e].webcam,t=GlobalData.WFU[e].webcamProps;a.updatePlayProgress(t.duration),a.updateTimer()},wfu_webcam_init_svginjector=function(){!function(e,a){"use strict";var t="file:"===e.location.protocol,r=a.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),s=Array.prototype.forEach||function(e,a){if(null==this||"function"!=typeof e)throw new TypeError;var t,r=this.length>>>0;for(t=0;r>t;++t)t in this&&e.call(a,this[t],t,this)},o={},n=0,i=[],l=[],u={},d=function(e){return e.cloneNode(!0)},_=function(e,a){l[e]=l[e]||[],l[e].push(a)},c=function(a,r){if(void 0!==o[a])o[a]instanceof SVGSVGElement?r(d(o[a])):_(a,r);else{if(!e.XMLHttpRequest)return r("Browser does not support XMLHttpRequest"),!1;o[a]={},_(a,r);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState){if(404===s.status||null===s.responseXML)return r("Unable to load SVG file: "+a),t&&r("Note: SVG injection ajax calls do not work locally without adjusting security setting in your browser. Or consider using a local webserver."),r(),!1;if(!(200===s.status||t&&0===s.status))return r("There was a problem injecting the SVG: "+s.status+" "+s.statusText),!1;if(s.responseXML instanceof Document)o[a]=s.responseXML.documentElement;else if(DOMParser&&DOMParser instanceof Function){var e;try{e=(new DOMParser).parseFromString(s.responseText,"text/xml")}catch(a){e=void 0}if(!e||e.getElementsByTagName("parsererror").length)return r("Unable to parse SVG file: "+a),!1;o[a]=e.documentElement}!function(e){for(var a=0,t=l[e].length;t>a;a++)!function(a){setTimeout((function(){l[e][a](d(o[e]))}),0)}(a)}(a)}},s.open("GET",a),s.overrideMimeType&&s.overrideMimeType("text/xml"),s.send()}},f=function(a,t,o,l){var d=a.getAttribute("data-src")||a.getAttribute("src");if(/\.svg/i.test(d))if(r)-1===i.indexOf(a)&&(i.push(a),a.setAttribute("src",""),c(d,(function(r){if(void 0===r||"string"==typeof r)return l(r),!1;var o=a.getAttribute("id");o&&r.setAttribute("id",o);var _=a.getAttribute("title");_&&r.setAttribute("title",_);var c=[].concat(r.getAttribute("class")||[],"injected-svg",a.getAttribute("class")||[]).join(" ");r.setAttribute("class",function(e){for(var a={},t=(e=e.split(" ")).length,r=[];t--;)a.hasOwnProperty(e[t])||(a[e[t]]=1,r.unshift(e[t]));return r.join(" ")}(c));var f=a.getAttribute("style");f&&r.setAttribute("style",f);var p=[].filter.call(a.attributes,(function(e){return/^data-\w[\w\-]*$/.test(e.name)}));s.call(p,(function(e){e.name&&e.value&&r.setAttribute(e.name,e.value)}));var m,g,b,w,h,v={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(v).forEach((function(e){m=e,b=v[e];for(var a=0,t=(g=r.querySelectorAll("defs "+m+"[id]")).length;t>a;a++){var o;w=g[a].id,h=w+"-"+n,s.call(b,(function(e){for(var a=0,t=(o=r.querySelectorAll("["+e+'*="'+w+'"]')).length;t>a;a++)o[a].setAttribute(e,"url(#"+h+")")})),g[a].id=h}})),r.removeAttribute("xmlns:a");for(var G,y,x=r.querySelectorAll("script"),D=[],k=0,P=x.length;P>k;k++)(y=x[k].getAttribute("type"))&&"application/ecmascript"!==y&&"application/javascript"!==y||(G=x[k].innerText||x[k].textContent,D.push(G),r.removeChild(x[k]));if(D.length>0&&("always"===t||"once"===t&&!u[d])){for(var U=0,F=D.length;F>U;U++)new Function(D[U])(e);u[d]=!0}var j=r.querySelectorAll("style");s.call(j,(function(e){e.textContent+=""})),a.parentNode.replaceChild(r,a),delete i[i.indexOf(a)],a=null,n++,l(r)})));else{var _=a.getAttribute("data-fallback")||a.getAttribute("data-png");_?(a.setAttribute("src",_),l(null)):o?(a.setAttribute("src",o+"/"+d.split("/").pop().replace(".svg",".png")),l(null)):l("This browser does not support SVG and no PNG fallback was defined.")}else l("Attempted to inject a file with a non-svg extension: "+d)},p=function(e,a,t){var r=(a=a||{}).evalScripts||"always",o=a.pngFallback||!1,n=a.each;if(void 0!==e.length){var i=0;s.call(e,(function(a){f(a,r,o,(function(a){n&&"function"==typeof n&&n(a),t&&e.length===++i&&t(i)}))}))}else e?f(e,r,o,(function(a){n&&"function"==typeof n&&n(a),t&&t(1),e=null})):t&&t(0)};"object"==typeof module&&"object"==typeof module.exports?module.exports=exports=p:"function"==typeof define&&define.amd?define((function(){return p})):"object"==typeof e&&(e.SVGInjector=p)}(window,document)},wfu_webcam_initialize_toBlob=function(){!function(e){"use strict";var a=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,t=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=t&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),s=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,n=(t||s)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var a,n,i,l,u,d,_,c,f;if(!(a=e.match(o)))throw new Error("invalid data URI");for(n=a[2]?a[1]:"text/plain"+(a[3]||";charset=US-ASCII"),i=!!a[4],l=e.slice(a[0].length),u=i?atob(l):decodeURIComponent(l),d=new ArrayBuffer(u.length),_=new Uint8Array(d),c=0;c<u.length;c+=1)_[c]=u.charCodeAt(c);return t?new Blob([r?_:d],{type:n}):((f=new s).append(d),f.getBlob(n))};e.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(e,t,r){e(r&&a.toDataURL&&n?n(this.toDataURL(t,r)):this.mozGetAsFile("blob",t))}:a.toDataURL&&n&&(a.toBlob=function(e,a,t){e(n(this.toDataURL(a,t)))})),"function"==typeof define&&define.amd?define((function(){return n})):"object"==typeof module&&module.exports?module.exports=n:e.dataURLtoBlob=n}(window),window.wfu_toBlob_function_initialized=!0},wfu_mediarecorder_mimetype=function(e){var a=["webm","mp4","x-matroska","ogg"],t=["vp9","vp9.0","vp8","vp8.0","avc1","av1","h265","h.265","h264","h.264","mpeg","theora"],r=["opus","vorbis","aac","mpeg","mp4a","pcm"],s=GlobalData.WFU[e].webcamProps,o=null;if(""!=GlobalData.consts.notify_testmode.wfu_mediarecorder_mimetype&&MediaRecorder.isTypeSupported(GlobalData.consts.notify_testmode.wfu_mediarecorder_mimetype))return GlobalData.consts.notify_testmode.wfu_mediarecorder_mimetype;if(!0===s.audio)for(var n=0;n<a.length;++n){for(var i=a[n],l=0;l<t.length;++l){for(var u=t[l],d=0;d<r.length;++d){var _=`video/${i};codecs=${u},${r[d]}`;if(MediaRecorder.isTypeSupported(_)){o=_;break}}if(null!=o)break}if(null!=o)break}else for(n=0;n<a.length;++n){for(i=a[n],l=0;l<t.length;++l)if(_=`video/${i};codecs=${u=t[l]}`,MediaRecorder.isTypeSupported(_)){o=_;break}if(null!=o)break}return o},wfu_run_js_from_bank();
